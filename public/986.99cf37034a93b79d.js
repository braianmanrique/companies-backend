"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[986],{1986:(Le,y,l)=>{l.r(y),l.d(y,{ChildRoutesModule:()=>$e});var e=l(3020);let Y=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-dashboard"]],decls:2,vars:0,template:function(t,r){1&t&&(e.TgZ(0,"p"),e._uU(1,"dashboard works!"),e.qZA())}}),i})();var c=l(5030),M=l(5226),d=l.n(M),C=l(3071),Q=l(162),u=l(4755);function $(i,n){if(1&i&&e._UZ(0,"img",23),2&i){const t=e.oxw();e.Q6J("src",t.user.imageUrl,e.LSH)}}function L(i,n){if(1&i&&e._UZ(0,"img",24),2&i){const t=e.oxw();e.Q6J("src",t.imgTemp,e.LSH)}}let O=(()=>{class i{constructor(t,r,s){this.fb=t,this.userService=r,this.fileUploadService=s,this.user=r.user}ngOnInit(){this.profileForm=this.fb.group({name:[this.user.name,c.kI.required],email:[this.user.email,[c.kI.required,c.kI.email]]})}updateProfile(){this.userService.updateProfile(this.profileForm.value).subscribe({next:()=>{const{name:t,email:r}=this.profileForm.value;this.user.name=t,this.user.email=r,d().fire("Saved","Changes were saved","success")},error:t=>{d().fire("error",t.error.msg,"error")}})}changeImage(t){if(this.imageUpload=t,!t)return this.imgTemp=null;const r=new FileReader;return r.readAsDataURL(t),r.onloadend=()=>{this.imgTemp=r.result},!0}uploadImage(){this.fileUploadService.updatePhoto(this.imageUpload,"users",this.user.uid).then(t=>{this.user.img=t,d().fire("Saved","Changes were saved","success")}).catch(t=>{d().fire("Error","No se pudo subir la imagen","error")})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(c.qu),e.Y36(C.K),e.Y36(Q.J))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-profile"]],decls:42,vars:5,consts:[[1,"row"],[1,"col-md-6"],[1,"card"],[1,"card-body"],[1,"card-title"],[1,"card-subtitle"],[1,"form","p-t-20",3,"formGroup","ngSubmit"],[1,"form-group"],["for","exampleInputuname"],[1,"input-group"],[1,"input-group-addon"],[1,"ti-user"],["type","text","formControlName","name","id","exampleInputuname","placeholder","Name",1,"form-control"],["for","exampleInputEmail1"],[1,"ti-email"],["type","email","formControlName","email","id","exampleInputEmail1","placeholder","Enter email",1,"form-control"],["type","submit",1,"btn-block","btn","btn-success","waves-effect","waves-light","m-r-10",3,"disabled"],[1,"fa","fa-save"],[1,"text-center"],["class","img-avatar",3,"src",4,"ngIf"],["class","img-avatar","alt","",3,"src",4,"ngIf"],["type","file",1,"form-control-file","form-control",3,"change"],["type","button",1,"btn-block","btn","btn-success","waves-effect","waves-light","m-r-10",3,"disabled","click"],[1,"img-avatar",3,"src"],["alt","",1,"img-avatar",3,"src"]],template:function(t,r){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h4",4),e._uU(5,"My profile"),e.qZA(),e.TgZ(6,"h6",5),e._uU(7,"Settings"),e.qZA(),e.TgZ(8,"form",6),e.NdJ("ngSubmit",function(){return r.updateProfile()}),e.TgZ(9,"div",7)(10,"label",8),e._uU(11,"User Name"),e.qZA(),e.TgZ(12,"div",9)(13,"div",10),e._UZ(14,"i",11),e.qZA(),e._UZ(15,"input",12),e.qZA()(),e.TgZ(16,"div",7)(17,"label",13),e._uU(18,"Email address"),e.qZA(),e.TgZ(19,"div",9)(20,"div",10),e._UZ(21,"i",14),e.qZA(),e._UZ(22,"input",15),e.qZA()(),e.TgZ(23,"button",16),e._UZ(24,"i",17),e._uU(25," Submit"),e.qZA()()()()(),e.TgZ(26,"div",1)(27,"div",2)(28,"div",3)(29,"h4",4),e._uU(30,"Image"),e.qZA(),e.TgZ(31,"h6",5),e._uU(32,"User image"),e.qZA(),e.TgZ(33,"div",18),e.YNc(34,$,1,1,"img",19),e.YNc(35,L,1,1,"img",20),e.qZA(),e.TgZ(36,"input",21),e.NdJ("change",function(o){return r.changeImage(o.target.files[0])}),e.qZA(),e._UZ(37,"br")(38,"br"),e.TgZ(39,"button",22),e.NdJ("click",function(){return r.uploadImage()}),e._UZ(40,"i",17),e._uU(41,"Change image"),e.qZA()()()()()),2&t&&(e.xp6(8),e.Q6J("formGroup",r.profileForm),e.xp6(15),e.Q6J("disabled",r.profileForm.invalid),e.xp6(11),e.Q6J("ngIf",!r.imgTemp),e.xp6(1),e.Q6J("ngIf",r.imgTemp),e.xp6(4),e.Q6J("disabled",!r.imageUpload))},dependencies:[u.O5,c._Y,c.Fj,c.JJ,c.JL,c.sg,c.u]}),i})();var E=l(727);class P extends E.w0{constructor(n,t){super()}schedule(n,t=0){return this}}const f={setInterval(i,n,...t){const{delegate:r}=f;return r?.setInterval?r.setInterval(i,n,...t):setInterval(i,n,...t)},clearInterval(i){const{delegate:n}=f;return(n?.clearInterval||clearInterval)(i)},delegate:void 0};var G=l(8737);const S={now:()=>(S.delegate||Date).now(),delegate:void 0};class h{constructor(n,t=h.now){this.schedulerActionCtor=n,this.now=t}schedule(n,t=0,r){return new this.schedulerActionCtor(this,n).schedule(r,t)}}h.now=S.now;const I=new class D extends h{constructor(n,t=h.now){super(n,t),this.actions=[],this._active=!1}flush(n){const{actions:t}=this;if(this._active)return void t.push(n);let r;this._active=!0;do{if(r=n.execute(n.state,n.delay))break}while(n=t.shift());if(this._active=!1,r){for(;n=t.shift();)n.unsubscribe();throw r}}}(class H extends P{constructor(n,t){super(n,t),this.scheduler=n,this.work=t,this.pending=!1}schedule(n,t=0){var r;if(this.closed)return this;this.state=n;const s=this.id,o=this.scheduler;return null!=s&&(this.id=this.recycleAsyncId(o,s,t)),this.pending=!0,this.delay=t,this.id=null!==(r=this.id)&&void 0!==r?r:this.requestAsyncId(o,this.id,t),this}requestAsyncId(n,t,r=0){return f.setInterval(n.flush.bind(n,this),r)}recycleAsyncId(n,t,r=0){if(null!=r&&this.delay===r&&!1===this.pending)return t;null!=t&&f.clearInterval(t)}execute(n,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const r=this._execute(n,t);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(n,t){let s,r=!1;try{this.work(n)}catch(o){r=!0,s=o||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),s}unsubscribe(){if(!this.closed){const{id:n,scheduler:t}=this,{actions:r}=t;this.work=this.state=this.scheduler=null,this.pending=!1,(0,G.P)(r,this),null!=n&&(this.id=this.recycleAsyncId(t,n,null)),this.delay=null,super.unsubscribe()}}}),K=I;var R=l(7272),q=l(5698),B=l(4482),z=l(5403),j=l(5032),V=l(9718),W=l(5577),ee=l(8421);function w(i,n){return n?t=>(0,R.z)(n.pipe((0,q.q)(1),function X(){return(0,B.e)((i,n)=>{i.subscribe((0,z.x)(n,j.Z))})}()),t.pipe(w(i))):(0,W.z)((t,r)=>(0,ee.Xf)(i(t,r)).pipe((0,q.q)(1),(0,V.h)(t)))}var te=l(9751),ie=l(3532);function _(i,n=I){const t=function ne(i=0,n,t=K){let r=-1;return null!=n&&((0,ie.K)(n)?t=n:r=n),new te.y(s=>{let o=function re(i){return i instanceof Date&&!isNaN(i)}(i)?+i-t.now():i;o<0&&(o=0);let a=0;return t.schedule(function(){s.closed||(s.next(a++),0<=r?this.schedule(void 0,r):s.complete())},o)})}(i,n);return w(()=>t)}var v=l(2340),m=l(4004),se=l(4872),b=l(3144);const J=v.N.base_url;let Z=(()=>{class i{constructor(t){this.http=t}get token(){return localStorage.getItem("token")||""}get headers(){return{headers:{"x-token":this.token}}}transformUsers(t){return t.map(r=>new se.n(r.name,r.email,r.identification,"",r.role,r.img,r.uid))}transformCompanies(t){return t}transformArticles(t){return t}globalSearch(t){return this.http.get(`${J}/all/${t}`,this.headers)}search(t,r=""){return this.http.get(`${J}/all/collection/${t}/${r}`,this.headers).pipe((0,m.U)(o=>{switch(console.log(o),t){case"users":return this.transformUsers(o.data);case"companies":return this.transformCompanies(o.data);case"articles":return this.transformArticles(o.data);default:return[]}}))}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(b.eN))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var T=l(9960);function oe(i,n){1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",8)(3,"h4",9),e._uU(4,"Loading.."),e.qZA(),e._UZ(5,"i",10),e.TgZ(6,"p",11),e._uU(7,"Please wait"),e.qZA()()()())}function ae(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"tr")(1,"td",22)(2,"img",23),e.NdJ("click",function(){const o=e.CHM(t).$implicit,a=e.oxw(2);return e.KtG(a.openModal(o))}),e.qZA()(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td")(10,"select",24),e.NdJ("ngModelChange",function(s){const a=e.CHM(t).$implicit;return e.KtG(a.role=s)})("change",function(){const o=e.CHM(t).$implicit,a=e.oxw(2);return e.KtG(a.changeRole(o))}),e.TgZ(11,"option",25),e._uU(12,"Admin"),e.qZA(),e.TgZ(13,"option",26),e._uU(14,"User"),e.qZA()()(),e.TgZ(15,"td",27)(16,"a",28),e.NdJ("click",function(){const o=e.CHM(t).$implicit,a=e.oxw(2);return e.KtG(a.deleteUser(o))}),e._UZ(17,"i",29),e.qZA()()()}if(2&i){const t=n.$implicit;e.xp6(2),e.Q6J("src",t.imageUrl,e.LSH),e.xp6(2),e.Oqu(t.email),e.xp6(2),e.Oqu(t.name),e.xp6(2),e.Oqu(t.identification),e.xp6(2),e.Q6J("ngModel",t.role)}}function ce(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"button",30),e.NdJ("click",function(){e.CHM(t);const s=e.oxw(2);return e.KtG(s.changePage(-5))}),e._uU(2,"Previous"),e.qZA(),e._uU(3," \xa0 "),e.TgZ(4,"button",30),e.NdJ("click",function(){e.CHM(t);const s=e.oxw(2);return e.KtG(s.changePage(5))}),e._uU(5,"Next"),e.qZA()()}}function le(i,n){if(1&i&&(e.TgZ(0,"div",12)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h4",13),e._uU(5),e.qZA(),e.TgZ(6,"h6",14),e._uU(7,"Users registered"),e.qZA(),e.TgZ(8,"div",15)(9,"table",16)(10,"thead")(11,"tr")(12,"th",17),e._uU(13,"Avatar"),e.qZA(),e.TgZ(14,"th"),e._uU(15,"Email"),e.qZA(),e.TgZ(16,"th"),e._uU(17,"Name"),e.qZA(),e.TgZ(18,"th"),e._uU(19,"Identification"),e.qZA(),e.TgZ(20,"th",18),e._uU(21,"Role"),e.qZA(),e.TgZ(22,"th",19),e._uU(23,"Actions"),e.qZA()()(),e.TgZ(24,"tbody"),e.YNc(25,ae,18,5,"tr",20),e.qZA()()(),e.YNc(26,ce,6,0,"div",21),e.qZA()()()()),2&i){const t=e.oxw(),r=e.MAs(5);e.xp6(5),e.hij("Total Users ",t.totalUsers,""),e.xp6(20),e.Q6J("ngForOf",t.users),e.xp6(1),e.Q6J("ngIf",0===r.value.length)}}let de=(()=>{class i{constructor(t,r,s){this.userService=t,this.searchesService=r,this.modalImageService=s,this.totalUsers=0,this.users=[],this.usersTemp=[],this.from=0,this.loading=!0}ngOnDestroy(){this.imageSubs.unsubscribe()}ngOnInit(){this.uploadUsers(),this.imageSubs=this.modalImageService.newImage.pipe(_(100)).subscribe(t=>this.uploadUsers())}uploadUsers(){this.loading=!0,this.userService.uploadUsers(this.from).subscribe({next:({total:t,users:r})=>{this.totalUsers=t,this.users=r,this.usersTemp=r,this.loading=!1},error:t=>{console.log(t)}})}changePage(t){this.from+=t,this.from<0?this.from=0:this.from>this.totalUsers&&(this.from-=t),this.uploadUsers()}search(t){return 0===t.length?this.users=this.usersTemp:(this.searchesService.search("users",t).subscribe({next:r=>{this.users=r},error:r=>{console.log(r)}}),!0)}deleteUser(t){if(t.uid===this.userService.uid)return d().fire("Error","Do not eliminate yourself","error");d().fire({title:"Are you sure?",text:`delete to ${t.name}`,icon:"question",showCancelButton:!0,confirmButtonText:"Yes, delete it!"}).then(r=>{r.isConfirmed&&r.value&&this.userService.deleteUser(t).subscribe(s=>{d().fire("User Deleted!","User has been deleted.","success"),this.uploadUsers()})})}changeRole(t){this.userService.saveUser(t).subscribe(r=>{console.log(r)})}openModal(t){this.modalImageService.openModal("users",t.uid,t.img)}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(C.K),e.Y36(Z),e.Y36(T.e))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-usuarios"]],decls:8,vars:2,consts:[[1,"row","animate","fadeIn","fast"],[1,"col-12"],[1,"card"],[1,"card-body"],["type","text","placeholder","Search user...",1,"form-control",3,"keyup"],["txtTerm",""],["class","row animate fadeIn fast",4,"ngIf"],["class","row animated fadeIn fast",4,"ngIf"],[1,"alert","alert-info","text-center"],[1,"alert-heading"],[1,"fa","fa-spin","fa-refresh","fa-2x"],[1,"mb-0"],[1,"row","animated","fadeIn","fast"],[1,"card-title"],[1,"card-subtitle"],[1,"table-responsive"],[1,"table","table-bordered"],[1,"w100"],[1,"w140"],[1,"text-nowrap","w100"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"text-center"],["alt","avatar",1,"avatar","cursor",3,"src","click"],[1,"form-control",3,"ngModel","ngModelChange","change"],["value","ADMIN_ROLE"],["value","USER_ROLE"],[1,"text-nowrap","text-center"],["data-toggle","tooltip","data-original-title","Delete",1,"cursor",3,"click"],[1,"fa","fa-close","text-danger"],[1,"btn","btn-secondary",3,"click"]],template:function(t,r){if(1&t){const s=e.EpF();e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"input",4,5),e.NdJ("keyup",function(){e.CHM(s);const a=e.MAs(5);return e.KtG(r.search(a.value))}),e.qZA()()()()(),e.YNc(6,oe,8,0,"div",6),e.YNc(7,le,27,3,"div",7)}2&t&&(e.xp6(6),e.Q6J("ngIf",r.loading),e.xp6(1),e.Q6J("ngIf",!r.loading))},dependencies:[u.sg,u.O5,c.YN,c.Kr,c.EJ,c.JJ,c.On]}),i})();var ue=l(5861);const A=v.N.base_url;let N=(()=>{class i{constructor(t){this.http=t}get token(){return localStorage.getItem("token")||""}get headers(){return{headers:{"x-token":this.token}}}uploadCompanies(){return this.http.get(`${A}/companies`,this.headers).pipe((0,m.U)(r=>r.data))}createCompany(t,r){return this.http.post(`${A}/companies`,{name:t,nit:r},this.headers).pipe((0,m.U)(o=>o))}updateCompany(t,r){return this.http.put(`${A}/companies/${t}`,{name:r},this.headers).pipe((0,m.U)(o=>o.company))}deleteCompany(t){return this.http.delete(`${A}/companies/${t}`,this.headers)}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(b.eN))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const F=v.N.base_url;let x=(()=>{class i{transform(t,r){return t?`${F}/uploads/${r}/${t}`:`${F}/uploads/users/no-image`}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275pipe=e.Yjl({name:"image",type:i,pure:!0}),i})();function pe(i,n){1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",8)(3,"h4",9),e._uU(4,"Loading"),e.qZA(),e._UZ(5,"i",10),e.TgZ(6,"p",11),e._uU(7,"Please wait"),e.qZA()()()())}function me(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"tr")(1,"td",25)(2,"img",26),e.NdJ("click",function(){const o=e.CHM(t).$implicit,a=e.oxw(2);return e.KtG(a.openModal(o))}),e.ALo(3,"image"),e.qZA()(),e.TgZ(4,"td"),e._uU(5),e.qZA(),e.TgZ(6,"td")(7,"input",27),e.NdJ("ngModelChange",function(s){const a=e.CHM(t).$implicit;return e.KtG(a.name=s)}),e.qZA()(),e.TgZ(8,"td",28)(9,"a",29),e.NdJ("click",function(){const o=e.CHM(t).$implicit,a=e.oxw(2);return e.KtG(a.updateCompany(o))}),e._UZ(10,"i",30),e.qZA(),e.TgZ(11,"a",31),e.NdJ("click",function(){const o=e.CHM(t).$implicit,a=e.oxw(2);return e.KtG(a.deleteCompany(o))}),e._UZ(12,"i",32),e.qZA()()()}if(2&i){const t=n.$implicit;e.xp6(2),e.Q6J("src",e.xi3(3,4,t.img,"companies"),e.LSH)("alt",t.name),e.xp6(3),e.Oqu(t.nit),e.xp6(2),e.Q6J("ngModel",t.name)}}function he(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",12)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",12)(5,"div",13)(6,"h4",14),e._uU(7),e.qZA()(),e.TgZ(8,"div",15)(9,"div",16)(10,"button",17),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.openSweetAlert())}),e._UZ(11,"i",18),e._uU(12," New Company"),e.qZA()()()(),e._UZ(13,"br"),e.TgZ(14,"div",19)(15,"table",20)(16,"thead")(17,"tr")(18,"th",21),e._uU(19,"Photo"),e.qZA(),e.TgZ(20,"th"),e._uU(21,"Nit"),e.qZA(),e.TgZ(22,"th"),e._uU(23,"Name"),e.qZA(),e.TgZ(24,"th",22),e._uU(25,"Acciones"),e.qZA()()(),e.TgZ(26,"tbody"),e.YNc(27,me,13,7,"tr",23),e.qZA()()(),e.TgZ(28,"button",24),e._uU(29,"Previous"),e.qZA(),e._uU(30," \xa0 "),e.TgZ(31,"button",24),e._uU(32,"Nexts"),e.qZA()()()()()}if(2&i){const t=e.oxw();e.xp6(7),e.hij("Companies (",t.companies.length,")"),e.xp6(20),e.Q6J("ngForOf",t.companies)}}let ge=(()=>{class i{constructor(t,r,s){this.companyService=t,this.modalImageService=r,this.searchesService=s,this.companies=[],this.loading=!0}ngOnDestroy(){this.imageSubs.unsubscribe()}ngOnInit(){this.uploadCompanies(),this.imageSubs=this.modalImageService.newImage.pipe(_(100)).subscribe(t=>this.uploadCompanies())}uploadCompanies(){this.loading=!0,this.companyService.uploadCompanies().subscribe(t=>{this.companies=t,this.loading=!1})}updateCompany(t){this.companyService.updateCompany(t._id,t.name).subscribe(r=>{d().fire("Updated",t.name,"success")})}deleteCompany(t){this.companyService.deleteCompany(t._id).subscribe(r=>{this.uploadCompanies(),d().fire("Deleted",t.name,"success")})}openSweetAlert(){var t=this;return(0,ue.Z)(function*(){const{value:r}=yield d().fire({title:"Create Company",html:'<input required placeholder="name" id="swal-input1" class="swal2-input"><input required placeholder="nit" id="swal-input2" class="swal2-input">',inputLabel:"New Company",showCancelButton:!0,focusConfirm:!1,preConfirm:()=>{const s=document.getElementById("swal-input1").value;return console.log(s),[document.getElementById("swal-input1").value,document.getElementById("swal-input2").value]}});2===r?.length&&t.companyService.createCompany(r[0],r[1]).subscribe({next:s=>{console.log(s),t.companies.push(s.company),d().fire("Saaved",s.name,"success")},error:s=>{d().fire("Error",s.error.msg,"error")}})})()}openModal(t){this.modalImageService.openModal("companies",t._id,t.img)}search(t){return 0===t.length?this.uploadCompanies():(this.searchesService.search("companies",t).subscribe({next:r=>{this.companies=r},error:r=>{console.log(r)}}),!0)}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(N),e.Y36(T.e),e.Y36(Z))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-companies"]],decls:8,vars:2,consts:[[1,"row","animate","fadeIn","fast"],[1,"col-12"],[1,"card"],[1,"card-body"],["type","text","name","","placeholder","Search companies",1,"form-control",3,"keyup"],["txtTerm",""],["class","row animate fadeIn fast",4,"ngIf"],["class","row",4,"ngIf"],[1,"alert","alert-info","text-center"],[1,"alert-heading"],[1,"fa","fa-spin","fa-refresh","fa-2x"],[1,"mb-0"],[1,"row"],[1,"col-8"],[1,"card-title"],[1,"col"],[1,"text-right"],[1,"btn","btn-primary",3,"click"],[1,"fa","fa-save"],[1,"table-responsive"],[1,"table","table-bordered"],[1,"w100"],[1,"text-nowrap","w100"],[4,"ngFor","ngForOf"],[1,"btn","btn-secondary"],[1,"text-center"],[1,"w100","cursor",3,"src","alt","click"],["type","text","placeholder","Name",1,"form-control",3,"ngModel","ngModelChange"],[1,"text-nowrap","text-center"],["data-toggle","tooltip","data-original-title","Save",1,"cursor",3,"click"],[1,"fa","fa-pencil","text-inverse","m-r-10"],["data-toggle","tooltip","data-original-title","Delete",1,"cursor",3,"click"],[1,"fa","fa-close","text-danger"]],template:function(t,r){if(1&t){const s=e.EpF();e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"input",4,5),e.NdJ("keyup",function(){e.CHM(s);const a=e.MAs(5);return e.KtG(r.search(a.value))}),e.qZA()()()()(),e.YNc(6,pe,8,0,"div",6),e.YNc(7,he,33,2,"div",7)}2&t&&(e.xp6(6),e.Q6J("ngIf",r.loading),e.xp6(1),e.Q6J("ngIf",!r.loading))},dependencies:[u.sg,u.O5,c.Fj,c.JJ,c.On,x]}),i})();const g=v.N.base_url;let k=(()=>{class i{constructor(t){this.http=t}get token(){return localStorage.getItem("token")||""}get headers(){return{headers:{"x-token":this.token}}}sharedArticles(){return this.http.get(`${g}/articles`,this.headers).pipe((0,m.U)(r=>r.articles))}getArticleById(t){return this.http.get(`${g}/articles/${t}`,this.headers).pipe((0,m.U)(s=>s.article))}createArticle(t){return this.http.post(`${g}/articles`,t,this.headers)}updateArticle(t){return this.http.put(`${g}/articles/${t._id}`,t,this.headers)}deleteArticle(t){return this.http.delete(`${g}/articles/${t}`,this.headers)}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(b.eN))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var p=l(4660);function fe(i,n){1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",8)(3,"h4",9),e._uU(4,"Loading.."),e.qZA(),e._UZ(5,"i",10),e.TgZ(6,"p",11),e._uU(7,"Please wait"),e.qZA()()()())}const _e=function(i){return["/dashboard/article",i]};function ve(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"tr")(1,"td",28)(2,"img",29),e.NdJ("click",function(){const o=e.CHM(t).$implicit,a=e.oxw(2);return e.KtG(a.openModal(o))}),e.ALo(3,"image"),e.qZA()(),e.TgZ(4,"td"),e._uU(5),e.qZA(),e.TgZ(6,"td"),e._uU(7),e.qZA(),e.TgZ(8,"td",30)(9,"a",31),e._UZ(10,"i",32),e.qZA(),e.TgZ(11,"a",33),e.NdJ("click",function(){const o=e.CHM(t).$implicit,a=e.oxw(2);return e.KtG(a.deleteArticle(o))}),e._UZ(12,"i",34),e.qZA()()()}if(2&i){const t=n.$implicit;e.xp6(2),e.Q6J("src",e.xi3(3,5,t.img,"articles"),e.LSH)("alt",t.name),e.xp6(3),e.Oqu(t.name),e.xp6(2),e.Oqu(t.company.name),e.xp6(2),e.Q6J("routerLink",e.VKq(8,_e,t._id))}}const U=function(){return["/dashboard/article","new"]};function Ze(i,n){if(1&i&&(e.TgZ(0,"div",12)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",12)(5,"div",13)(6,"h4",14),e._uU(7),e.qZA()(),e.TgZ(8,"div",15)(9,"div",16)(10,"a",17),e._UZ(11,"i",18),e._uU(12," Download"),e.qZA(),e.TgZ(13,"a",19),e._UZ(14,"i",20),e._uU(15," Send Email"),e.qZA(),e.TgZ(16,"a",19),e._UZ(17,"i",21),e._uU(18," New Article"),e.qZA()()()(),e._UZ(19,"br"),e.TgZ(20,"div",22)(21,"table",23)(22,"thead")(23,"tr")(24,"th",24),e._uU(25,"Photo"),e.qZA(),e.TgZ(26,"th"),e._uU(27,"Name"),e.qZA(),e.TgZ(28,"th"),e._uU(29,"Company"),e.qZA(),e.TgZ(30,"th",25),e._uU(31,"Actions"),e.qZA()()(),e.TgZ(32,"tbody"),e.YNc(33,ve,13,10,"tr",26),e.qZA()()(),e.TgZ(34,"button",27),e._uU(35,"Anterior"),e.qZA(),e._uU(36," \xa0 "),e.TgZ(37,"button",27),e._uU(38,"Siguientes"),e.qZA()()()()()),2&i){const t=e.oxw();e.xp6(7),e.hij("Articles (",t.articles.length,")"),e.xp6(3),e.Q6J("routerLink",e.DdM(5,U)),e.xp6(3),e.Q6J("routerLink",e.DdM(6,U)),e.xp6(3),e.Q6J("routerLink",e.DdM(7,U)),e.xp6(17),e.Q6J("ngForOf",t.articles)}}let Ae=(()=>{class i{constructor(t,r,s){this.articleService=t,this.modalImageService=r,this.searchesService=s,this.articles=[],this.loading=!0}ngOnDestroy(){this.imageSubs.unsubscribe()}ngOnInit(){this.sharedArticles(),this.imageSubs=this.modalImageService.newImage.pipe(_(100)).subscribe(t=>this.sharedArticles())}createPdf(){}sharedArticles(){this.loading=!0,this.articleService.sharedArticles().subscribe(t=>{this.loading=!1,this.articles=t})}openModal(t){this.modalImageService.openModal("articles",t._id,t.img)}search(t){return 0===t.length?this.sharedArticles():(this.searchesService.search("articles",t).subscribe({next:r=>{this.articles=r},error:r=>{console.log(r)}}),!0)}deleteArticle(t){d().fire({title:"Are you sure?",text:`delete to ${t.name}`,icon:"question",showCancelButton:!0,confirmButtonText:"Yes, delete it!"}).then(r=>{r.isConfirmed&&r.value&&this.articleService.deleteArticle(t._id).subscribe(s=>{d().fire("Article Deleted!","ok.","success"),this.sharedArticles()})})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(k),e.Y36(T.e),e.Y36(Z))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-articles"]],decls:8,vars:2,consts:[[1,"row","animate","fadeIn","fast"],[1,"col-12"],[1,"card"],[1,"card-body"],["type","text","placeholder","Search Article",1,"form-control",3,"keyup"],["txtTerm",""],["class","row animate fadeIn fast",4,"ngIf"],["class","row",4,"ngIf"],[1,"alert","alert-info","text-center"],[1,"alert-heading"],[1,"fa","fa-spin","fa-refresh","fa-2x"],[1,"mb-0"],[1,"row"],[1,"col-8"],[1,"card-title"],[1,"col"],[1,"text-right"],[1,"btn","btn-danger",3,"routerLink"],[1,"fa","fa-download"],[1,"btn","btn-primary","ml-3",3,"routerLink"],[1,"fa","fa-mail-forward"],[1,"fa","fa-save"],[1,"table-responsive"],[1,"table","table-bordered"],[1,"w75"],[1,"text-nowrap","w100"],[4,"ngFor","ngForOf"],[1,"btn","btn-secondary"],[1,"text-center"],[1,"w100","cursor",3,"src","alt","click"],[1,"text-nowrap","text-center"],["data-toggle","tooltip","data-original-title","Edit",1,"cursor",3,"routerLink"],[1,"fa","fa-pencil","text-inverse","m-r-10"],["data-toggle","tooltip","data-original-title","Delete",1,"cursor",3,"click"],[1,"fa","fa-close","text-danger"]],template:function(t,r){if(1&t){const s=e.EpF();e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"input",4,5),e.NdJ("keyup",function(){e.CHM(s);const a=e.MAs(5);return e.KtG(r.search(a.value))}),e.qZA()()()()(),e.YNc(6,fe,8,0,"div",6),e.YNc(7,Ze,39,8,"div",7)}2&t&&(e.xp6(6),e.Q6J("ngIf",r.loading),e.xp6(1),e.Q6J("ngIf",!r.loading))},dependencies:[u.sg,u.O5,p.rH,x]}),i})();function xe(i,n){if(1&i&&(e.TgZ(0,"div",8)(1,"label",9),e._uU(2,"Photo"),e.qZA(),e.TgZ(3,"div",10),e._UZ(4,"img",22),e.ALo(5,"image"),e.qZA()()),2&i){const t=e.oxw();e.xp6(4),e.Q6J("src",e.xi3(5,1,t.articleSelected.img,"articles"),e.LSH)}}function Ce(i,n){if(1&i&&(e.TgZ(0,"option",23),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.Q6J("value",t._id),e.xp6(1),e.Oqu(t.name)}}function be(i,n){if(1&i&&(e.TgZ(0,"div",24)(1,"div",2)(2,"div",3)(3,"h4"),e._uU(4,"Company"),e.qZA(),e.TgZ(5,"h6"),e._uU(6),e.qZA(),e._UZ(7,"img",25),e.ALo(8,"image"),e.qZA()()()),2&i){const t=e.oxw();e.xp6(6),e.Oqu(t.companySelected.name),e.xp6(1),e.Q6J("src",e.xi3(8,2,t.companySelected.img,"companies"),e.LSH)}}let Te=(()=>{class i{ngOnInit(){this.activatedRoute.params.subscribe(({id:t})=>{this.sharedArticle(t)}),this.shareCompanies(),this.articleForm.get("company")?.valueChanges.subscribe(t=>{this.companySelected=this.companies.find(r=>r._id===t)})}constructor(t,r,s,o,a){this.fb=t,this.articleService=r,this.companyService=s,this.router=o,this.activatedRoute=a,this.companies=[],this.articleForm=this.fb.group({name:["",c.kI.required],company:["",c.kI.required]})}sharedArticle(t){"new"!==t&&this.articleService.getArticleById(t).pipe(_(100)).subscribe(r=>{if(!r)return this.router.navigateByUrl("/dashboard/articles");const{name:s,company:{}}=r;this.articleForm.setValue({name:s,company:r.company._id}),this.articleSelected=r})}savedArticle(){if(this.articleSelected){console.log(this.articleSelected);let t={...this.articleForm.value,_id:this.articleSelected._id};this.articleService.updateArticle(t).subscribe(r=>{d().fire("Updated","Succes","success"),console.log("rta",r)})}else this.articleService.createArticle(this.articleForm.value).subscribe(t=>{console.log(t),d().fire("Saved","Succes","success"),this.router.navigateByUrl(`/dashboard/article/${t.article._id}`)})}shareCompanies(){this.companyService.uploadCompanies().subscribe(t=>{console.log(t),this.companies=t})}goArticles(){this.router.navigateByUrl("/dashboard/articles")}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(c.qu),e.Y36(k),e.Y36(N),e.Y36(p.F0),e.Y36(p.gz))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-article"]],decls:33,vars:5,consts:[[1,"row"],[1,"col-md-6"],[1,"card"],[1,"card-body"],[1,"card-title"],[1,"card-subtitle"],[1,"form","p-t-20",3,"formGroup","submit"],["class","form-group",4,"ngIf"],[1,"form-group"],["for","exampleInputuname"],[1,"input-group"],[1,"input-group-addon"],[1,"ti-user"],["type","text","formControlName","name","id","exampleInputuname","placeholder","name",1,"form-control"],["for","exampleInputEmail1"],["name","","id","","formControlName","company",1,"form-control"],["value",""],[3,"value",4,"ngFor","ngForOf"],["type","submit",1,"btn","btn-success","waves-effect","waves-light","m-r-10",3,"disabled"],[1,"fa","fa-save"],[1,"btn","btn-inverse","waves-effect","waves-light",3,"click"],["class","col fadeIn fast",4,"ngIf"],["alt","",1,"w100",3,"src"],[3,"value"],[1,"col","fadeIn","fast"],["alt","",1,"img-thumbnail",3,"src"]],template:function(t,r){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h4",4),e._uU(5,"Article"),e.qZA(),e.TgZ(6,"h6",5),e._uU(7,"data"),e.qZA(),e.TgZ(8,"form",6),e.NdJ("submit",function(){return r.savedArticle()}),e.YNc(9,xe,6,4,"div",7),e.TgZ(10,"div",8)(11,"label",9),e._uU(12,"Article Name"),e.qZA(),e.TgZ(13,"div",10)(14,"div",11),e._UZ(15,"i",12),e.qZA(),e._UZ(16,"input",13),e.qZA()(),e.TgZ(17,"div",8)(18,"label",14),e._uU(19,"Companies"),e.qZA(),e.TgZ(20,"div",10)(21,"div",11),e._UZ(22,"i",12),e.qZA(),e.TgZ(23,"select",15)(24,"option",16),e._uU(25,"Select Company"),e.qZA(),e.YNc(26,Ce,2,2,"option",17),e.qZA()()(),e.TgZ(27,"button",18),e._UZ(28,"i",19),e._uU(29," Saved"),e.qZA(),e.TgZ(30,"button",20),e.NdJ("click",function(){return r.goArticles()}),e._uU(31,"Cancel"),e.qZA()()()()(),e.YNc(32,be,9,5,"div",21),e.qZA()),2&t&&(e.xp6(8),e.Q6J("formGroup",r.articleForm),e.xp6(1),e.Q6J("ngIf",r.articleSelected),e.xp6(17),e.Q6J("ngForOf",r.companies),e.xp6(1),e.Q6J("disabled",r.articleForm.invalid),e.xp6(5),e.Q6J("ngIf",r.companySelected))},dependencies:[u.sg,u.O5,c._Y,c.YN,c.Kr,c.Fj,c.EJ,c.JJ,c.JL,c.sg,c.u,x]}),i})();function Ue(i,n){1&i&&(e.TgZ(0,"div"),e._uU(1,"loading"),e.qZA())}function ye(i,n){1&i&&(e.TgZ(0,"div",8)(1,"p",9),e._uU(2,"There are not users with this term"),e.qZA()())}function Se(i,n){if(1&i&&(e.TgZ(0,"tr",13)(1,"td"),e._UZ(2,"img",14),e.ALo(3,"image"),e.qZA(),e.TgZ(4,"td"),e._uU(5),e.qZA()()),2&i){const t=n.$implicit;e.xp6(2),e.Q6J("src",e.xi3(3,2,t.img,"users"),e.LSH),e.xp6(3),e.Oqu(t.name)}}function Ie(i,n){if(1&i&&(e.TgZ(0,"div",10)(1,"table",11)(2,"thead")(3,"tr")(4,"th"),e._uU(5,"Avatar"),e.qZA(),e.TgZ(6,"th"),e._uU(7,"Name"),e.qZA()()(),e.TgZ(8,"tbody"),e.YNc(9,Se,6,5,"tr",12),e.qZA()()()),2&i){const t=e.oxw(2);e.xp6(9),e.Q6J("ngForOf",t.usersArr)}}function qe(i,n){1&i&&(e.TgZ(0,"div",8)(1,"p",9),e._uU(2,"There are not articles with this term"),e.qZA()())}const we=function(i){return["/dashboard/article",i]};function Je(i,n){if(1&i&&(e.TgZ(0,"tr",13)(1,"td"),e._UZ(2,"img",14),e.ALo(3,"image"),e.qZA(),e.TgZ(4,"td",15),e._UZ(5,"a"),e._uU(6),e.qZA()()),2&i){const t=n.$implicit;e.xp6(2),e.Q6J("src",e.xi3(3,3,t.img,"articles"),e.LSH),e.xp6(2),e.Q6J("routerLink",e.VKq(6,we,t._id)),e.xp6(2),e.hij(" ",t.name,"")}}function Ne(i,n){if(1&i&&(e.TgZ(0,"div",10)(1,"table",11)(2,"thead")(3,"tr")(4,"th"),e._uU(5,"Image"),e.qZA(),e.TgZ(6,"th"),e._uU(7,"Name"),e.qZA()()(),e.TgZ(8,"tbody"),e.YNc(9,Je,7,8,"tr",12),e.qZA()()()),2&i){const t=e.oxw(2);e.xp6(9),e.Q6J("ngForOf",t.articles)}}function Fe(i,n){1&i&&(e.TgZ(0,"div",8)(1,"p",9),e._uU(2,"There are not companies with this term"),e.qZA()())}function ke(i,n){if(1&i&&(e.TgZ(0,"tr",13)(1,"td"),e._UZ(2,"img",14),e.ALo(3,"image"),e.qZA(),e.TgZ(4,"td"),e._uU(5),e.qZA()()),2&i){const t=n.$implicit;e.xp6(2),e.Q6J("src",e.xi3(3,2,t.img,"companies"),e.LSH),e.xp6(3),e.Oqu(t.name)}}function Ye(i,n){if(1&i&&(e.TgZ(0,"div",10)(1,"table",11)(2,"thead")(3,"tr")(4,"th"),e._uU(5,"Image"),e.qZA(),e.TgZ(6,"th"),e._uU(7,"Name"),e.qZA()()(),e.TgZ(8,"tbody"),e.YNc(9,ke,6,5,"tr",12),e.qZA()()()),2&i){const t=e.oxw(2);e.xp6(9),e.Q6J("ngForOf",t.companies)}}function Me(i,n){if(1&i&&(e.TgZ(0,"div",2)(1,"div",3)(2,"div",4)(3,"div",5)(4,"h3"),e._uU(5,"Users"),e.qZA(),e.YNc(6,ye,3,0,"div",6),e.YNc(7,Ie,10,1,"div",7),e.qZA()()(),e.TgZ(8,"div",3)(9,"div",4)(10,"div",5)(11,"h3"),e._uU(12,"Articles"),e.qZA(),e.YNc(13,qe,3,0,"div",6),e.YNc(14,Ne,10,1,"div",7),e.qZA()()(),e.TgZ(15,"div",3)(16,"div",4)(17,"div",5)(18,"h3"),e._uU(19,"Companies"),e.qZA(),e.YNc(20,Fe,3,0,"div",6),e.YNc(21,Ye,10,1,"div",7),e.qZA()()()()),2&i){const t=e.oxw();e.xp6(6),e.Q6J("ngIf",0===t.usersArr.length),e.xp6(1),e.Q6J("ngIf",0!==t.usersArr.length),e.xp6(6),e.Q6J("ngIf",0===t.articles.length),e.xp6(1),e.Q6J("ngIf",0!==t.usersArr.length),e.xp6(6),e.Q6J("ngIf",0===t.companies.length),e.xp6(1),e.Q6J("ngIf",0!==t.companies.length)}}const Qe=[{path:"",component:Y,data:{title:"Dashboard"}},{path:"profile",component:O,data:{title:"User profile"}},{path:"search/:term",component:(()=>{class i{constructor(t,r){this.activateRoute=t,this.searchService=r,this.usersArr=[],this.companies=[],this.articles=[],this.loading=!0}ngOnInit(){this.loading=!0,this.activateRoute.params.subscribe(({term:t})=>{this.globalSearch(t),this.loading=!1})}globalSearch(t){this.searchService.globalSearch(t).subscribe(r=>{this.usersArr=r.users,this.companies=r.companies,this.articles=r.articles})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(p.gz),e.Y36(Z))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-search"]],decls:2,vars:2,consts:[[4,"ngIf"],["class","row animated fadeIn fast",4,"ngIf"],[1,"row","animated","fadeIn","fast"],[1,"col-4"],[1,"card"],[1,"card-body"],["class","alert alert-info",4,"ngIf"],["class","table-responsive",4,"ngIf"],[1,"alert","alert-info"],[1,"mb-o"],[1,"table-responsive"],[1,"table"],["class","animated fadeIn fast",4,"ngFor","ngForOf"],[1,"animated","fadeIn","fast"],["alt","",1,"w75",3,"src"],[3,"routerLink"]],template:function(t,r){1&t&&(e.YNc(0,Ue,2,0,"div",0),e.YNc(1,Me,22,6,"div",1)),2&t&&(e.Q6J("ngIf",!0===r.loading),e.xp6(1),e.Q6J("ngIf",!1===r.loading))},dependencies:[u.sg,u.O5,p.rH,x]}),i})(),data:{title:"Searches"}},{path:"users",canActivate:[(()=>{class i{constructor(t,r){this.userService=t,this.router=r}canActivate(t,r){return"ADMIN_ROLE"===this.userService.role||(this.router.navigateByUrl("/dashboard"),!1)}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(C.K),e.LFG(p.F0))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})()],component:de,data:{title:"App users"}},{path:"companies",component:ge,data:{title:"Supporting Companies"}},{path:"articles",component:Ae,data:{title:"Supporting Articles"}},{path:"article/:id",component:Te,data:{title:"Supporting Articles"}}];let $e=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[p.Bz.forChild(Qe),p.Bz]}),i})()}}]);